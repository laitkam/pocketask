<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Pocket Tasks</title>

<style>
:root{
  --bg:#f6f7fb;--card:#fff;--text:#111827;--muted:#6b7280;
  --done:#9ca3af;--accent:#111827;
}
[data-theme="dark"]{
  --bg:#0f172a;--card:#020617;--text:#e5e7eb;
  --muted:#94a3b8;--done:#64748b;--accent:#e5e7eb;
}
*{box-sizing:border-box}

/* Top-aligned layout */
body{
  margin:0;
  min-height:100vh;
  display:flex;
  justify-content:flex-start;
  align-items:stretch;
  padding:16px;
  background:var(--bg);
  color:var(--text);
  font-family:system-ui,Segoe UI,Roboto,sans-serif;
}

/* Splash */
#splash{
  position:fixed;inset:0;
  background:var(--bg);
  display:flex;align-items:center;justify-content:center;
  z-index:100;
  transition:opacity .4s ease;
}
#splash.hide{opacity:0;pointer-events:none}
.splash-box{text-align:center}
.splash-logo{
  width:64px;height:64px;border-radius:16px;
  background:var(--accent);
  display:flex;align-items:center;justify-content:center;
  margin:0 auto 14px;
}
.splash-logo svg{width:34px;height:34px;stroke:var(--bg)}
.splash-title{font-size:22px;font-weight:600}
.splash-sub{font-size:13px;color:var(--muted);margin-top:4px}

/* Card */
.card{
  width:100%;
  max-width:520px;
  margin:0 auto;
  background:var(--card);
  padding:20px;
  border-radius:16px;
  box-shadow:0 10px 30px rgba(0,0,0,.15);
}

/* Header */
.header{
  display:flex;justify-content:space-between;
  align-items:center;margin-bottom:14px;
}
.brand{display:flex;gap:12px;align-items:center}
.logo{
  width:40px;height:40px;border-radius:10px;
  background:var(--accent);
  display:flex;align-items:center;justify-content:center;
}
.logo svg{width:22px;height:22px;stroke:var(--bg)}
.title-wrap h1{margin:0;font-size:18px}
.subtitle{font-size:12px;color:var(--muted)}

/* Theme toggle (pill style) */
.theme-toggle{
  width:56px;height:30px;
  border-radius:999px;
  border:2px solid #facc15;
  background:#000;
  padding:3px;
  display:flex;align-items:center;
  cursor:pointer;
}
.theme-toggle .sun{
  width:20px;height:20px;
  border-radius:50%;
  background:#facc15;
  display:flex;align-items:center;justify-content:center;
  font-size:12px;
  transition:transform .25s ease;
}
[data-theme="dark"] .theme-toggle .sun{
  transform:translateX(26px);
}

/* App */
.row{display:flex;gap:8px;align-items:center}
input{
  flex:1;padding:10px;border-radius:8px;
  border:1px solid #cbd5f5;background:transparent;color:inherit
}
button{
  padding:10px 12px;border-radius:8px;border:0;
  background:var(--accent);color:var(--bg);cursor:pointer
}
button.ghost{background:transparent;color:var(--muted)}
ul{list-style:none;padding:0;margin:12px 0 0}
li{
  display:flex;gap:8px;align-items:center;
  padding:8px;border-radius:8px;
  cursor:grab;
}
li.dragging{opacity:.4}
.chk{
  width:18px;height:18px;border:1px solid var(--muted);
  display:flex;align-items:center;justify-content:center;
  border-radius:4px
}
.done{text-decoration:line-through;color:var(--done)}
footer{
  display:flex;justify-content:space-between;
  font-size:12px;color:var(--muted);margin-top:10px
}

/* Confirm dialog */
.modal{
  position:fixed;inset:0;
  background:rgba(0,0,0,.55);
  display:flex;align-items:center;justify-content:center;
  opacity:0;pointer-events:none;
  transition:opacity .18s ease;
}
.modal.show{opacity:1;pointer-events:auto}
.dialog{
  background:var(--card);
  padding:16px;border-radius:14px;width:320px;
  transform:scale(.92);
  transition:transform .18s ease;
}
.modal.show .dialog{transform:scale(1)}
.dialog p{margin:0 0 14px;font-size:14px}
.dialog .actions{display:flex;justify-content:flex-end;gap:8px}
.dialog .actions button:last-child{
  background:#dc2626;color:#fff;
}
</style>
</head>

<body>

<!-- Splash -->
<div id="splash">
  <div class="splash-box">
    <div class="splash-logo">
      <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
        <path d="M6 3h12a1 1 0 0 1 1 1v16l-7-4-7 4V4a1 1 0 0 1 1-1z"/>
        <path d="M9 8l2 2 4-4"/>
      </svg>
    </div>
    <div class="splash-title">Pocket Tasks</div>
    <div class="splash-sub">Your tasks, always with you</div>
  </div>
</div>

<main class="card">
  <div class="header">
    <div class="brand">
      <div class="logo">
        <svg viewBox="0 0 24 24" fill="none" stroke-width="2">
          <path d="M6 3h12a1 1 0 0 1 1 1v16l-7-4-7 4V4a1 1 0 0 1 1-1z"/>
          <path d="M9 8l2 2 4-4"/>
        </svg>
      </div>
      <div class="title-wrap">
        <h1>Pocket Tasks</h1>
        <div class="subtitle">Your tasks, always with you</div>
      </div>
    </div>

    <div id="themeBtn" class="theme-toggle">
      <div class="sun">☀</div>
    </div>
  </div>

  <div class="row">
    <input id="input" placeholder="Add a task…" autocomplete="off">
    <button onclick="add()">Add</button>
  </div>

  <ul id="list"></ul>

  <footer>
    <span id="count"></span>
    <button class="ghost" onclick="confirmClear()">Clear done</button>
  </footer>
</main>

<!-- Confirm -->
<div id="confirm" class="modal" hidden>
  <div class="dialog">
    <p id="confirmText">Are you sure?</p>
    <div class="actions">
      <button class="ghost" onclick="closeConfirm(false)">Cancel</button>
      <button onclick="closeConfirm(true)">Confirm</button>
    </div>
  </div>
</div>

<script>
/* Splash */
setTimeout(()=>document.getElementById('splash').classList.add('hide'),1200);

/* Storage */
const KEY='pocket-tasks:v1';
let tasks=JSON.parse(localStorage.getItem(KEY)||'[]');

/* Theme */
const themeBtn=document.getElementById('themeBtn');
document.documentElement.dataset.theme=localStorage.getItem('theme')||'light';
themeBtn.onclick=()=>{
  const t=document.documentElement.dataset.theme==='dark'?'light':'dark';
  document.documentElement.dataset.theme=t;
  localStorage.setItem('theme',t);
};

/* Haptic */
function haptic(){
  if(navigator.vibrate) navigator.vibrate(10);
}

/* Confirm */
const modal=document.getElementById('confirm');
const text=document.getElementById('confirmText');
let resolveConfirm=null;

function confirmBox(msg){
  text.textContent=msg;
  modal.hidden=false;
  requestAnimationFrame(()=>modal.classList.add('show'));
  return new Promise(r=>resolveConfirm=r);
}
function closeConfirm(val){
  modal.classList.remove('show');
  setTimeout(()=>{
    modal.hidden=true;
    resolveConfirm&&resolveConfirm(val);
    resolveConfirm=null;
  },180);
}
modal.onclick=e=>e.target===modal&&closeConfirm(false);

/* App */
const list=document.getElementById('list');
const input=document.getElementById('input');
const count=document.getElementById('count');

function save(){
  localStorage.setItem(KEY,JSON.stringify(tasks));
  render();
}

function add(){
  if(!input.value.trim())return;
  tasks.unshift({id:crypto.randomUUID(),text:input.value,done:false});
  input.value='';
  save();
  input.focus();
}

input.addEventListener('keydown',e=>{
  if(e.key==='Enter'){
    e.preventDefault();
    add();
  }
});

async function confirmClear(){
  if(await confirmBox('Clear all completed tasks?')){
    tasks=tasks.filter(t=>!t.done);
    save();
  }
}

/* Drag */
let dragEl=null;
list.addEventListener('dragstart',e=>{
  dragEl=e.target;dragEl.classList.add('dragging');
});
list.addEventListener('dragend',()=>{
  dragEl.classList.remove('dragging');
  tasks=[...list.children].map(li=>tasks.find(t=>t.id===li.dataset.id));
  save();
});
list.addEventListener('dragover',e=>{
  e.preventDefault();
  const after=[...list.children].find(el=>{
    const box=el.getBoundingClientRect();
    return e.clientY<box.top+box.height/2;
  });
  after?list.insertBefore(dragEl,after):list.appendChild(dragEl);
});

/* Render */
function render(){
  list.innerHTML='';
  tasks.forEach((t,i)=>{
    const li=document.createElement('li');
    li.dataset.id=t.id;
    li.draggable=true;
    li.innerHTML=`
      <div class="chk">${t.done?'✓':''}</div>
      <div class="${t.done?'done':''}" style="flex:1">${t.text}</div>
      <button class="ghost">✕</button>`;
    li.onclick=async e=>{
      if(e.target.tagName==='BUTTON'){
        if(await confirmBox('Delete this task?')){
          tasks.splice(i,1);
          save();
        }
      }else{
        t.done=!t.done;
        if(t.done) haptic();
        save();
      }
    };
    list.appendChild(li);
  });
  count.textContent=
    `${tasks.filter(t=>!t.done).length} remaining • ${tasks.length} total`;
}
render();
</script>
</body>
</html>